sequenceDiagram
    participant C as Client
    participant InitSurvey as InitializeSurveySubscriber<br>.net core
    participant PS as Google Cloud<br>Pub/Sub
    participant SaveSurvey as SaveSurveySubscriber<br>.net core
    participant F as Google Cloud<br>Firestore
    participant SaveSurveyStatus as SaveSurveyStatusSubscriber<br>.net core
    C--)+PS: INITALIZE_SURVEY
    PS--)+InitSurvey: INITALIZE_SURVEY
    deactivate PS
    %% SAVE_SURVEY
    InitSurvey--)PS: SAVE_SURVEY
    activate PS
    PS--)SaveSurvey: SAVE_SURVEY
    deactivate PS
    activate SaveSurvey
    SaveSurvey->>+F: save survey
    F-->>SaveSurvey: response
    deactivate F
    deactivate SaveSurvey
    %% SAVE_SURVEY_STATUS
    InitSurvey--)PS: SAVE_SURVEY_STATUS
    activate PS
    PS--)+SaveSurveyStatus: SAVE_SURVEY_STATUS
    deactivate PS
    SaveSurveyStatus->>+F: save survey status
    F-->>SaveSurveyStatus: response
    deactivate F
    deactivate SaveSurveyStatus
    loop for each participant
        InitSurvey--)PS: SAVE_SURVEY_RESULT
        activate PS
        deactivate PS
    end
    InitSurvey--)PS: CREATE_MAIL
    activate PS
    deactivate PS
    deactivate InitSurvey