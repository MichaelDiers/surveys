function apiCall(n,l,c={}){return new Promise((a,e)=>{const s=new XMLHttpRequest,t=(s.onreadystatechange=t=>{if(4===t.target.readyState)if(200===t.target.status){let e;if(t.target.responseText){const r=s.getResponseHeader("content-type");e=r.startsWith("text/html")?t.target.responseText:JSON.parse(t.target.responseText)}a(e)}else e()},s.open(l,n,!0),s.withCredentials=!0,c)["formData"];if(t){const o={};t.forEach((e,t)=>{o[t]=e});var r=JSON.stringify(o);s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("CSRF-Token",t.get("_csrf")),s.send(r)}else s.send()})}console.log("runs frame");const subViewForms=o=>{const e=o.querySelectorAll("form");e&&e.forEach(s=>{s.addEventListener("submit",e=>{e.preventDefault();var t=e.target.getAttribute("method"),r=e.target.getAttribute("action"),e=new FormData(e.target);o.classList.add("loader"),apiCall(r,t,{formData:e}).then(a=>{const e=document.querySelectorAll(".sub-view");e&&e.forEach(r=>{r.querySelectorAll("form").forEach(async e=>{if(e.id&&e.id===s.id){await new Promise(e=>setTimeout(e,2e3)),o.classList.remove("loader"),r.innerHTML=a;const t=r.querySelector("[name=pushStateUrl]");!t||(e=t.getAttribute("value"))&&window.history.pushState({},"",e)}})})}).catch(e=>console.log(e))})})},subViews=e=>{const t=e.querySelectorAll("[placeholder-ajax]");t&&t.forEach(r=>{var e=r.getAttribute("placeholder-ajax");r.classList.add("loader"),apiCall(e,"GET").then(e=>{const t=r;t.innerHTML=e,t.classList.remove("loader"),subViewForms(r),subViews(r)}).catch(e=>console.log(e))})},themeHandler=(subViews(document),()=>{document.querySelectorAll(".theme-toggle").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),document.querySelector("body").classList.toggle("light")})})});themeHandler();