function apiCall(n,l,i={}){return new Promise((r,e)=>{const a=new XMLHttpRequest,t=(a.onreadystatechange=t=>{if(4===t.target.readyState)if(200===t.target.status){let e;if(t.target.responseText){const s=a.getResponseHeader("content-type");e=s.startsWith("text/html")?t.target.responseText:JSON.parse(t.target.responseText)}r(e)}else e()},a.open(l,n,!0),a.withCredentials=!0,i)["formData"];if(t){const o={};t.forEach((e,t)=>{o[t]=e});var s=JSON.stringify(o);a.setRequestHeader("Content-type","application/json"),a.setRequestHeader("CSRF-Token",t.get("_csrf")),a.send(s)}else a.send()})}console.log("runs frame");const subViewForms=o=>{const e=o.querySelectorAll("form");e&&e.forEach(a=>{a.addEventListener("submit",e=>{e.preventDefault();var t=e.target.getAttribute("method"),s=e.target.getAttribute("action"),e=new FormData(e.target);o.classList.add("loader"),apiCall(s,t,{formData:e}).then(r=>{const e=document.querySelectorAll(".sub-view");e&&e.forEach(s=>{s.querySelectorAll("form").forEach(async e=>{if(e.id&&e.id===a.id){await new Promise(e=>setTimeout(e,2e3)),o.classList.remove("loader"),s.innerHTML=r;const t=s.querySelector("[name=pushStateUrl]");!t||(e=t.getAttribute("value"))&&window.history.pushState({},"",e)}})})}).catch(e=>console.log(e))})})},subViews=e=>{const t=e.querySelectorAll("[placeholder]");t&&t.forEach(s=>{var e=s.getAttribute("placeholder");s.classList.add("loader"),apiCall(e,"GET").then(e=>{const t=s;t.innerHTML=e,t.classList.remove("loader"),subViewForms(s),subViews(s)}).catch(e=>console.log(e))})};subViews(document);